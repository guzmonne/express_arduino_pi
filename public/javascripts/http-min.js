var __extends=this.__extends||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}c.prototype=a.prototype;f.prototype=new c()};var Http;(function(a){var c=(function(){function i(){this.xhr=new XMLHttpRequest();this.promise=new g();this.requestManager=new d(this)}i.prototype.resume=function(j){if(j==="resolve"&&this.promise[j]!==undefined){this.promise[j](this.response)}if(j==="reject"&&this.promise[j]!==undefined){this.promise[j](this.xhr.statusText,this.xhr.status)}};i.prototype.start=function(){this.requestManager.process();return this.promise};i.prototype.restart=function(){this.requestManager.process();return this.promise};return i})();a.Request=c;var h=(function(i){__extends(j,i);function j(k,l){i.call(this);this.type="GET";if(k===undefined){throw new Error("Parameters mismatched")}this.url=k;l===undefined?this.async=true:this.async=false}return j})(c);a.Get=h;var b=(function(j){__extends(i,j);function i(k,m,l){j.call(this);this.type="POST";if(k===undefined||m===undefined){throw new Error("Parameters mismatched")}l===undefined?this.async=true:this.async=false;this.url=k;this.data=m;return this}return i})(c);a.Post=b;var f=(function(j){__extends(i,j);function i(k,m,l){j.call(this);this.type="PUT";if(k===undefined||m===undefined){throw new Error("Parameters mismatched")}l===undefined?this.async=true:this.async=false;this.url=k;this.data=m;return this}return i})(c);a.Put=f;var e=(function(j){__extends(i,j);function i(k,m,l){j.call(this);this.type="DELETE";if(k===undefined||m===undefined){throw new Error("Parameters mismatched")}l===undefined?this.async=true:this.async=false;this.url=k;this.data=m;return this}return i})(c);a.Delete=e;var d=(function(){function i(j){this.request=j}i.prototype.verifyStatus=function(){return !(this.request.xhr.status<200||this.request.xhr.status>=300&&this.request.xhr.status!==304)};i.prototype.statedChanged=function(){if(this.verifyStatus()){return this.parseData()}return this.request.resume.call(this.request,"reject")};i.prototype.parseData=function(){if(this.request.xhr.getResponseHeader("content-type")=="application/json"){this.request.response=JSON.parse(this.request.xhr.response)}else{this.request.response=this.request.xhr.response}return this.request.resume.call(this.request,"resolve")};i.prototype.process=function(){this.request.xhr.open(this.request.type,this.request.url,this.request.async);this.request.xhr.onload=this.statedChanged.bind(this);this.request.xhr.send(this.prepareData())};i.prototype.prepareData=function(){if(typeof(this.request.data)==="object"){this.request.xhr.setRequestHeader("Content-Type","application/json");return JSON.stringify(this.request.data)}if(typeof(this.request.data)==="string"){return this.request.data}return null};return i})();a.RequestManager=d;var g=(function(){function i(){}i.prototype.fail=function(j){this.reject=j};i.prototype.then=function(k,j){this.resolve=k;j!==undefined?this.reject=j:false};return i})();a.Promise=g})(Http||(Http={}));